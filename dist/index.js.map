{"version":3,"sources":["index.ts"],"names":[],"mappings":";AAmDC,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,MAAA,aAAA,EAAA,EAAA,IAAA,EAAA,SAAA,GAAA,EAAA,MAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,EAAA,MAAA,KAAA,aAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,MAAA,EAAA,KAAA,WAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,KAAA,GAAA,IAAA,IAAA,OAAA,EAAA,CAAA,KAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,mBAAA,SAAA,EAAA,OAAA,UAAA,WAAA,OAAA,OAAA,EAAA,SAAA,EAAA,GAAA,OAAA,SAAA,GAAA,OAAA,SAAA,GAAA,GAAA,EAAA,MAAA,IAAA,UAAA,mCAAA,KAAA,GAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,GAAA,EAAA,SAAA,EAAA,EAAA,KAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,OAAA,EAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,GAAA,EAAA,QAAA,EAAA,IAAA,KAAA,EAAA,KAAA,EAAA,EAAA,EAAA,MAAA,KAAA,EAAA,OAAA,EAAA,QAAA,CAAA,MAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,GAAA,EAAA,CAAA,GAAA,SAAA,KAAA,EAAA,EAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,QAAA,KAAA,GAAA,EAAA,EAAA,MAAA,OAAA,GAAA,EAAA,EAAA,OAAA,MAAA,IAAA,EAAA,IAAA,IAAA,EAAA,IAAA,CAAA,EAAA,EAAA,SAAA,GAAA,IAAA,EAAA,MAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,CAAA,EAAA,MAAA,EAAA,GAAA,MAAA,GAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,EAAA,MAAA,GAAA,GAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,KAAA,GAAA,MAAA,EAAA,IAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,EAAA,EAAA,KAAA,EAAA,GAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,QAAA,EAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAnDD,IAAM,EAAU,+BACV,EAAc,2CAQd,EAAoB,WAAA,OAAA,OAAA,OAAA,EAAU,QAAO,WA0C1C,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EAjCgB,OART,EAAQ,IAAI,YAAY,IAC9B,OAAO,OAAO,gBAAgB,GACxB,EAAW,MAAM,KAAK,EAAO,SAAC,GAClC,OAAC,IAAM,EAAI,SAAS,KAAK,QAAQ,KACjC,KAAK,IAED,EAAU,IAAI,YACd,EAAO,EAAQ,OAAO,GACb,CAAA,EAAM,OAAO,OAAO,OAAO,OAAO,UAAW,IAiC7D,KAAA,EA5BC,OALM,EAAS,EAAA,OACT,EAAY,KAAK,OAAO,aAAY,MAAnB,OAAuB,IAAI,WAAW,KAC1D,QAAQ,MAAO,KACf,QAAQ,MAAO,KACf,QAAQ,KAAM,IACjB,CAAA,EAAO,CAAE,SAAQ,EAAE,UAAS,UAIxB,EAAsB,SAC1B,EACA,EACA,GAEU,OAAA,EAAO,+BAA+B,EAAQ,iBAAiB,UACvE,GACD,mBAAmB,GAIhB,EAAS,WAAA,OAAA,OAAA,OAAA,OAAA,EAAA,WAad,IAAA,EAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EAZuB,MAAA,CAAA,EAAM,KAY7B,KAAA,EAAA,OAZO,EAAgB,EAAA,OAChB,EAAM,EACV,SACA,EACA,EAAc,WAEhB,OAAO,SAAS,KAAO,EAMxB,CAAA,SAHG,EAAO,SAAS,OAAO,MAAM,KAAK,OAAO,SAAC,GAAM,OAAA,EAAE,QAAQ,SAAW,IAAG,GACvE,GACH","file":"index.js","sourceRoot":"..","sourcesContent":["const baseURL = \"https://api.leeapps.cn/daily\";\r\nconst redirectUri = \"https://api.leeapps.cn/static/?auth=true\";\r\n\r\nexport interface CodeChallenge {\r\n  challenge: string;\r\n  verifier: string;\r\n}\r\n\r\n// 创建 code_challenge\r\nconst generateChallenge = async (): Promise<CodeChallenge> => {\r\n  const array = new Uint32Array(32);\r\n  window.crypto.getRandomValues(array);\r\n  const verifier = Array.from(array, (dec) =>\r\n    (\"0\" + dec.toString(16)).substr(-2)\r\n  ).join(\"\");\r\n\r\n  const encoder = new TextEncoder();\r\n  const data = encoder.encode(verifier);\r\n  const hashed = await window.crypto.subtle.digest(\"SHA-256\", data);\r\n  const challenge = btoa(String.fromCharCode(...new Uint8Array(hashed)))\r\n    .replace(/\\+/g, \"-\")\r\n    .replace(/\\//g, \"_\")\r\n    .replace(/=/g, \"\");\r\n  return { verifier, challenge };\r\n};\r\n\r\n// 获取授权接口\r\nconst getAuthorizationUrl = (\r\n  provider: string,\r\n  redirectUri: string,\r\n  codeChallenge: string\r\n): string => {\r\n  return `${baseURL}/v1/auth/authorize?provider=${provider}&redirect_uri=${encodeURI(\r\n    redirectUri\r\n  )}&code_challenge=${codeChallenge}`;\r\n};\r\n\r\n// 跳转授权页面\r\nconst goAuth = async () => {\r\n  const codeChallenge = await generateChallenge();\r\n  const url = getAuthorizationUrl(\r\n    \"github\",\r\n    redirectUri,\r\n    codeChallenge.challenge\r\n  );\r\n  window.location.href = url;\r\n};\r\n\r\nlet auth = location.search.split(\"&\").filter((v) => v.indexOf(\"auth\") > -1)[0];\r\nif (!auth) {\r\n  goAuth();\r\n}\r\n\r\n"]}